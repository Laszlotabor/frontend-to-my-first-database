<div class="container py-5" *ngIf="currentUser; else notLoggedIn">
    <div class="card shadow p-4 mb-4" style="max-width: 600px; margin: auto; border-radius: 1rem;">
      <h3 class="mb-3">Welcome, {{ currentUser.username }}!</h3>
      <p>Email: {{ currentUser.useremail }}</p>
  
      <hr />
  
      <h4>Add New Contact</h4>
      <form (ngSubmit)="addContact()" #contactForm="ngForm" class="mb-4">
        <div class="mb-3">
          <input
            type="text"
            name="name"
            [(ngModel)]="newContact.name"
            placeholder="Name"
            required
            class="form-control"
            #nameInput="ngModel"
            [class.is-invalid]="nameInput.invalid && nameInput.touched"
          />
          <div class="invalid-feedback">Name is required.</div>
        </div>
  
        <div class="mb-3">
          <input
            type="email"
            name="email"
            [(ngModel)]="newContact.email"
            placeholder="Email"
            required
            class="form-control"
            #emailInput="ngModel"
            [class.is-invalid]="emailInput.invalid && emailInput.touched"
          />
          <div class="invalid-feedback">Valid email is required.</div>
        </div>
  
        <div class="mb-3">
          <input
            type="text"
            name="phone"
            [(ngModel)]="newContact.phone"
            placeholder="Phone"
            required
            class="form-control"
            #phoneInput="ngModel"
            [class.is-invalid]="phoneInput.invalid && phoneInput.touched"
          />
          <div class="invalid-feedback">Phone is required.</div>
        </div>
  
        <button type="submit" class="btn btn-primary w-100" [disabled]="contactForm.invalid">
          Add Contact
        </button>
      </form>
  
      <hr />
  
      <h4>Your Contacts</h4>
      <ul class="list-group mb-4">
        <li
          *ngFor="let contact of contacts"
          class="list-group-item d-flex justify-content-between align-items-center"
        >
          <div>
            <strong>{{ contact.name }}</strong> — {{ contact.email }} — {{ contact.phone }}
          </div>
          <div>
            <button
              class="btn btn-sm btn-outline-secondary me-2"
              (click)="selectContactForEdit(contact)"
            >
              Edit
            </button>
            <button class="btn btn-sm btn-outline-danger" (click)="deleteContact(contact.id)">
              Delete
            </button>
          </div>
        </li>
      </ul>
  
      <div *ngIf="editingContact" class="card p-3 bg-light rounded">
        <h5>Edit Contact</h5>
        <form (ngSubmit)="updateContact()" #editForm="ngForm">
          <div class="mb-3">
            <input
              type="text"
              [(ngModel)]="editingContact.name"
              name="editName"
              required
              class="form-control"
            />
          </div>
  
          <div class="mb-3">
            <input
              type="email"
              [(ngModel)]="editingContact.email"
              name="editEmail"
              required
              class="form-control"
            />
          </div>
  
          <div class="mb-3">
            <input
              type="text"
              [(ngModel)]="editingContact.phone"
              name="editPhone"
              required
              class="form-control"
            />
          </div>
  
          <button type="submit" class="btn btn-success me-2">Save</button>
          <button type="button" class="btn btn-secondary" (click)="cancelEditing()">Cancel</button>
        </form>
      </div>
  
      <div class="text-center mt-4">
        <button class="btn btn-outline-danger" (click)="logout()">Logout</button>
      </div>
    </div>
  </div>
  
  <ng-template #notLoggedIn>
    <div class="text-center py-5">
      <h3>Please log in to see your contacts.</h3>
    </div>
  </ng-template>
  